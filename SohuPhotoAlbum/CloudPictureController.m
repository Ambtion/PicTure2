//
//  CloudPictureController.m
//  SohuPhotoAlbum
//
//  Created by sohu on 13-4-16.
//  Copyright (c) 2013å¹´ Qu. All rights reserved.
//

#import "CloudPictureController.h"
#import "CloundDetailController.h"
#import "ShareViewController.h"

@interface CloudPictureController()
@property(strong,nonatomic)NSMutableArray * dataSourceArray;
@property(strong,nonatomic)NSMutableArray * assetsArray;
@property(strong,nonatomic)NSMutableArray *assetsSection;
@property(strong,nonatomic)NSMutableArray *assetSectionisShow;
@end

@implementation CloudPictureController
@synthesize dataSourceArray = _dataSourceArray;
@synthesize assetsSection = _assetsSection;
@synthesize assetSectionisShow = _assetSectionisShow;
@synthesize assetDictionary = _assetDictionary;

- (void)viewDidLoad
{
    
    [super viewDidLoad];
    self.view.backgroundColor = LOCALBACKGORUNDCOLOR;
    self.myTableView = [[UITableView alloc] initWithFrame:self.view.bounds style:UITableViewStylePlain];
    self.myTableView.autoresizingMask = UIViewAutoresizingFlexibleHeight | UIViewAutoresizingFlexibleWidth;
    self.myTableView.delegate = self;
    self.myTableView.dataSource = self;
    self.myTableView.separatorStyle = UITableViewCellSeparatorStyleNone;
    _refresHeadView = [[EGORefreshTableHeaderView alloc] initWithFrame:CGRectMake(0, - 60, 320, 60) arrowImageName:nil textColor:[UIColor grayColor] backGroundColor:[UIColor clearColor]];
    _refresHeadView.delegate = self;
    [self.myTableView addSubview:_refresHeadView];
    [self.view addSubview:self.myTableView];
    
    _moreFootView = [[SCPMoreTableFootView alloc] initWithFrame:CGRectMake(0, 0, 320, 60) WithLodingImage:[UIImage imageNamed:@"load_more_pics.png"] endImage:[UIImage imageNamed:@"end_bg.png"] WithBackGroud:[UIColor clearColor]];
    _moreFootView.delegate = self;
    //    self.myTableView.tableFooterView = _moreFootView;
    [self initDataContainer];
    [self refrshDataFromNetWork];
    [[NSNotificationCenter defaultCenter] addObserver:self selector:@selector(cloudDetailDidDeletePhoto:) name:DELETEPHOTO object:nil];
}

- (void)initDataContainer
{
    selectedArray = [NSMutableArray arrayWithCapacity:0];
    _assetDictionary = [NSMutableDictionary dictionaryWithCapacity:0];
    _assetsSection = [NSMutableArray arrayWithCapacity:0];
    _assetSectionisShow = [NSMutableArray arrayWithCapacity:0];
    _dataSourceArray = [NSMutableArray arrayWithCapacity:0];
}

#pragma mark - Refresh
- (NSDate*)egoRefreshTableHeaderDataSourceLastUpdated:(EGORefreshTableHeaderView *)view
{
    return [NSDate date];
}
- (void)reloadTableViewDataSource
{
    _isLoading = YES;
    [self refrshDataFromNetWork];
}
- (void)doneRefrshLoadingTableViewData
{
    _isLoading = NO;
    [_refresHeadView egoRefreshScrollViewDataSourceDidFinishedLoading:self.myTableView];
}
- (void)egoRefreshTableHeaderDidTriggerRefresh:(EGORefreshTableHeaderView *)view
{
    [self reloadTableViewDataSource];
}
- (BOOL)egoRefreshTableHeaderDataSourceIsLoading:(EGORefreshTableHeaderView *)view
{
    return _isLoading;
}
//- (void)refeshOnce:(id)sender
//{
//    [_refresHeadView refreshImmediately];
//    [self reloadTableViewDataSource];
//}
#pragma mark - more
- (void)scpMoreTableFootViewDelegateDidTriggerRefresh:(SCPMoreTableFootView *)view
{
    [self moreTableViewDataSource];
}
- (BOOL)scpMoreTableFootViewDelegateDataSourceIsLoading:(SCPMoreTableFootView *)view
{
    return _isLoading;
}
- (void)moreTableViewDataSource
{
    _isLoading = YES;
    [self getMoreFromNetWork];
}
- (void)doneMoreLoadingTableViewData
{
    _isLoading = NO;
    [_moreFootView scpMoreScrollViewDataSourceDidFinishedLoading:self.myTableView];
}

#pragma mark - refrshDataFromNetWork
- (void)refrshDataFromNetWork
{
    [RequestManager getTimeStructWithAccessToken:[LoginStateManager currentToken] withtime:nil success:^(NSString *response) {
        [self initDataContainer];
        [self.assetsSection addObjectsFromArray:[[response JSONValue] objectForKey:@"days"]];
        [self reloadTableViewWithAssetsSection:self.assetsSection andRefresh:YES];
        [self.myTableView reloadData];
        [self doneRefrshLoadingTableViewData];
        [self scrollViewDidEndDecelerating:self.myTableView];
    } failure:^(NSString *error) {
        [self doneRefrshLoadingTableViewData];
    }];
}
- (void)getMoreFromNetWork
{

    NSString * time = [[self.assetsSection lastObject] objectForKey:@"day"];
    [RequestManager getTimeStructWithAccessToken:[LoginStateManager currentToken] withtime:time success:^(NSString *response) {
        NSArray * array = [[response JSONValue] objectForKey:@"days"];
        DLog(@"%@",array);
        if (array && array.count) {
            [self.assetsSection addObjectsFromArray:array];
            [self reloadTableViewWithAssetsSection:self.assetsSection andRefresh:YES];
            [self.myTableView reloadData];
        }
        [self doneMoreLoadingTableViewData];
        
    } failure:^(NSString *error) {
        [self doneMoreLoadingTableViewData];
    }];
}
- (void)reloadTableViewWithAssetsSection:(NSMutableArray *)asssetSection andRefresh:(BOOL)isRefresh
{
    NSInteger numberSource = _dataSourceArray.count;
    NSInteger numberAssection = asssetSection.count;
    for (int i = numberSource; i < numberAssection; i++) {
        NSDictionary * dic = [asssetSection objectAtIndex:i];
        [_dataSourceArray addObject:[self sectionSourceArrayWithSectionInfo:dic]];
        [self.assetSectionisShow addObject:[NSNumber numberWithBool:YES]];
    }
    
}
- (NSMutableArray *)sectionSourceArrayWithSectionInfo:(NSDictionary *)info
{
    NSInteger count = [[info objectForKey:@"count"] intValue];
    NSInteger last = count % 4;
    NSMutableArray * tempArray = [NSMutableArray arrayWithCapacity:0];
    for (int i = 0; i < count / 4; i++) {
        CloudPictureCellDataSource * soure = [[CloudPictureCellDataSource alloc] init];
        soure.firstDic  = soure.secoundDic = soure.thridDic = soure.lastDic = [NSMutableDictionary dictionaryWithCapacity:0];
        [tempArray addObject:soure];
    }
    CloudPictureCellDataSource * soure = [[CloudPictureCellDataSource alloc] init];
    switch (last) {
        case 3:
            soure.thridDic =  [NSMutableDictionary dictionaryWithCapacity:0];
        case 2:
            soure.secoundDic =  [NSMutableDictionary dictionaryWithCapacity:0];
        case 1:
            soure.firstDic =  [NSMutableDictionary dictionaryWithCapacity:0];
            break;
        default:
            break;
    }
    if (soure.firstDic) {
        [tempArray addObject:soure];
    }
    return tempArray;
}

#pragma mark - SectionClick
- (void)handleTapInSection:(UITapGestureRecognizer *)gesture
{
    NSNumber * num = [self.assetSectionisShow objectAtIndex:[gesture view].tag];
    BOOL isShow = ![num boolValue];
    [self.assetSectionisShow replaceObjectAtIndex:[gesture view].tag withObject:[NSNumber numberWithBool:isShow]];
//    [self.myTableView reloadData];
    [self.myTableView reloadSections:[NSIndexSet indexSetWithIndex:[gesture view].tag] withRowAnimation:UITableViewRowAnimationAutomatic];
}
#pragma mark Refresh-More function
- (void)scrollViewDidEndDecelerating:(UIScrollView *)scrollView
{
    NSArray * array = [self arraySectionForVisibleCell];
    for (NSNumber * number in array) {
        [self insertDataSourceWithDays:[number integerValue]];
    }
}

- (NSArray *)arraySectionForVisibleCell
{
    NSMutableArray * array = [NSMutableArray arrayWithCapacity:0];
    if (_dataSourceArray.count) {
        NSArray * cellArray = [self.myTableView visibleCells];
        for (UITableViewCell * vsCell in cellArray) {
            NSIndexPath * path = [self.myTableView indexPathForCell:vsCell];
            if (![array containsObject:[NSNumber numberWithInteger:path.section]]) {
                [array addObject:[NSNumber numberWithInteger:path.section]];
            }
        }
    }
    return array;
}
- (void)insertDataSourceWithDays:(NSInteger )section
{
    NSDictionary * dic = [self.assetsSection objectAtIndex:section];
    NSString * days = [dic objectForKey:@"day"];
    if ([_assetDictionary objectForKey:days]) {
        return;
    }
    [RequestManager getTimePhtotWithAccessToken:[LoginStateManager currentToken] day:days success:^(NSString *response) {
        NSMutableArray * array = [_dataSourceArray objectAtIndex:section];
        NSArray * photoArray = [[response JSONValue] objectForKey:@"photos"];
        [_assetDictionary setObject:photoArray forKey:days];
        [self insertInfo:photoArray intoDataSourceArray:array];
        [self.myTableView reloadSections:[NSIndexSet indexSetWithIndex:section] withRowAnimation:UITableViewRowAnimationFade];
    } failure:^(NSString *error) {
        
    }];
}

- (void)insertInfo:(NSArray *)photoInfo intoDataSourceArray:(NSArray *)sourceArray
{
    NSInteger count = photoInfo.count;
    NSInteger last = count % 4;
    for (int i = 0; i < count - last; i+=4) {
        CloudPictureCellDataSource * soure  = nil;
        if (i / 4 < sourceArray.count)
            soure = [sourceArray objectAtIndex:i / 4];
        soure.firstDic  = [photoInfo objectAtIndex:i];
        soure.secoundDic = [photoInfo objectAtIndex:i + 1];
        soure.thridDic = [photoInfo objectAtIndex:i + 2];
        soure.lastDic = [photoInfo objectAtIndex:i + 3];
    }
    if (last && count / 4 < sourceArray.count) {
        CloudPictureCellDataSource * soure = [sourceArray objectAtIndex:count / 4];
        switch (last) {
            case 3:
                soure.thridDic = [photoInfo objectAtIndex:(count / 4)*4 + 2];
            case 2:
                soure.secoundDic =  [photoInfo objectAtIndex:(count / 4)*4  + 1];
            case 1:
                soure.firstDic = [photoInfo objectAtIndex:(count / 4) * 4 ];
                break;
            default:
                break;
        }
    }
}
- (void)scrollViewDidEndDragging:(UIScrollView *)scrollView willDecelerate:(BOOL)decelerate
{
    [_refresHeadView egoRefreshScrollViewDidEndDragging:scrollView];
    [_moreFootView scpMoreScrollViewDidEndDragging:scrollView];
}
- (void)scrollViewDidScroll:(UIScrollView *)scrollView
{
    [_refresHeadView egoRefreshScrollViewDidScroll:scrollView];
    [_moreFootView scpMoreScrollViewDidScroll:scrollView isAutoLoadMore:YES WithIsLoadingPoint:&_isLoading];
}
#pragma mark DataSource
- (CGFloat)tableView:(UITableView *)tableView heightForHeaderInSection:(NSInteger)section
{
    return 28.f;
}
- (UIView *)tableView:(UITableView *)tableView viewForHeaderInSection:(NSInteger)section
{
    return [self getSectionView:section withImageCount:[[[_assetsSection objectAtIndex:section] objectForKey:@"count"] intValue] ByisShow:[[self.assetSectionisShow objectAtIndex:section] boolValue] WithTimeText:[[self.assetsSection objectAtIndex:section] objectForKey:@"day"]];
}
- (NSInteger)numberOfSectionsInTableView:(UITableView *)tableView
{
    return _assetsSection.count;
}
- (NSInteger)tableView:(UITableView *)tableView numberOfRowsInSection:(NSInteger)section
{
    if (!self.assetSectionisShow.count) return 0;
    return [[self.assetSectionisShow objectAtIndex:section] boolValue] ? [(NSMutableArray *)[self.dataSourceArray objectAtIndex:section] count]: 0;
}
- (void)tableView:(UITableView *)tableView willDisplayCell:(UITableViewCell *)cell forRowAtIndexPath:(NSIndexPath *)indexPath
{
    cell.backgroundColor = LOCALBACKGORUNDCOLOR;
}
- (CGFloat)tableView:(UITableView *)tableView heightForRowAtIndexPath:(NSIndexPath *)indexPath
{
    if (!self.dataSourceArray.count) return 0;
    if (indexPath.row == [(NSMutableArray *)[self.dataSourceArray objectAtIndex:indexPath.section] count] - 1) {
        return [CloudPictureCellDataSource cellLastHigth];
    }
    return [CloudPictureCellDataSource cellHigth];
}
- (UITableViewCell *)tableView:(UITableView *)tableView cellForRowAtIndexPath:(NSIndexPath *)indexPath
{
    static NSString * cellId = @"photoCELLId";
    CloudPictureCell * cell = [tableView dequeueReusableCellWithIdentifier:cellId];
    if (!cell) {
        cell = [[CloudPictureCell alloc] initWithStyle:UITableViewCellStyleDefault reuseIdentifier:cellId];
        cell.delegate = self;
    }
    if (indexPath.section < self.dataSourceArray.count
        && indexPath.row < [(NSMutableArray *)[self.dataSourceArray objectAtIndex:indexPath.section] count])
        cell.dataSource = [[[self dataSourceArray] objectAtIndex:indexPath.section] objectAtIndex:indexPath.row];
    if (_viewState != NomalState){
        [cell showCellSelectedStatus];
        [cell cloudPictureCellisShow:[selectedArray containsObject:cell.dataSource.firstDic] selectedDic:cell.dataSource.firstDic];
        [ cell cloudPictureCellisShow:[selectedArray containsObject:cell.dataSource.secoundDic] selectedDic:cell.dataSource.secoundDic];
        [cell cloudPictureCellisShow:[selectedArray containsObject:cell.dataSource.thridDic] selectedDic:cell.dataSource.thridDic];
        [cell cloudPictureCellisShow:[selectedArray containsObject:cell.dataSource.lastDic] selectedDic:cell.dataSource.lastDic];
    }else{
        [cell hiddenCellSelectedStatus];
    }
    return cell;
}

#pragma mark View LifeCircle
- (void)cloudDetailDidDeletePhoto:(NSNotification*)notification
{
    _shouldRefreshOnce = YES;
}
- (void)viewWillAppear:(BOOL)animated
{
    [super viewWillAppear:animated];
    if (!_cusBar){
        _cusBar = [[CustomizationNavBar alloc] initwithDelegate:self];
        [_cusBar.nLeftButton setImage:[UIImage imageNamed:@"list.png"] forState:UIControlStateNormal];
        [_cusBar.nLabelText setText:@"äºå¤ä»½"];
        [_cusBar.nRightButton1 setImage:[UIImage imageNamed:@"shareBtn_nomal.png"] forState:UIControlStateNormal];
        //ä¸ä¼ æé®
        [_cusBar.nRightButton2 setImage:[UIImage imageNamed:@"delete.png"] forState:UIControlStateNormal];
        [_cusBar.nRightButton3 setUserInteractionEnabled:NO];
        [_cusBar.sRightStateButton setImage:[UIImage imageNamed:@"ensure.png"] forState:UIControlStateNormal];
    }
    if (!_cusBar.superview)
        [self.navigationController.navigationBar addSubview:_cusBar];
    self.viewDeckController.panningMode = IIViewDeckFullViewPanning;
    if (_shouldRefreshOnce) {
        [self refrshDataFromNetWork];
        _shouldRefreshOnce = NO;
    }
}

#pragma mark Action
- (void)cusNavigationBar:(CustomizationNavBar *)bar buttonClick:(UIButton *)button isUPLoadState:(BOOL)isupload
{
    if (button.tag == LEFTBUTTON) {
        [self.viewDeckController toggleLeftViewAnimated:YES];
    }
    if (button.tag == RIGHT1BUTTON) {           //åäº«
        [self setViewState:ShareState];
    }
    if (button.tag == RIGHT2BUTTON) {           //å é¤
        [self setViewState:DeleteState];
    }
    if (button.tag == CANCELBUTTONTAG) {        //åæ¶
        [self setViewState:NomalState];
    }
    if (button.tag == RIGHTSELECTEDTAG) {       //ç¡®è®¤
        [self handleEnsureClick];
    }
}

- (void)cloudPictureCell:(CloudPictureCell *)cell clickInfo:(NSDictionary *)dic
{
    NSIndexPath * path = [self.myTableView indexPathForCell:cell];
    NSInteger  leftTime = 0;
    NSInteger  rightTime = 0;
    NSArray *  array = [self commentcontinuousTimeFormcurtimeSection:path.section ArrayAndSetLeftTime:&leftTime
                                                           RinghTime:&rightTime];
    CloundDetailController * cd = [[CloundDetailController alloc] initWithAssetsArray:array andCurAsset:dic];
    cd.sectionArray = self.assetsSection;
    cd.leftBoundsDays = leftTime;
    cd.rightBoudsDays = rightTime;
    [self.navigationController pushViewController:cd animated:YES];
}
- (NSArray *)commentcontinuousTimeFormcurtimeSection:(NSInteger)section ArrayAndSetLeftTime:(int *)lefttime RinghTime:(int *)rightTime
{
    
    NSMutableArray * rightarray = [NSMutableArray arrayWithCapacity:0];
    NSMutableArray * leftArray = [NSMutableArray arrayWithCapacity:0];
    for (int i = section - 1; i >=0 ; i--) {
        NSString * days = [[self.assetsSection objectAtIndex:i] objectForKey:@"day"];
        NSArray * array = [self.assetDictionary objectForKey:days];
        if (array) {
            * lefttime = i;
            [leftArray addObjectsFromArray:array];
        }else{
            break;
        }
    }
    for (int i = section + 1; i < self.assetsSection.count; i++) {
        NSString * days = [[self.assetsSection objectAtIndex:i] objectForKey:@"day"];
        NSArray * array = [self.assetDictionary objectForKey:days];
        if (array) {
            * rightTime = i;
            [rightarray addObjectsFromArray:array];
        }else{
            break;
        }
    }
    NSString * days = [[self.assetsSection objectAtIndex:section] objectForKey:@"day"];
    NSArray * array = [self.assetDictionary objectForKey:days];
    [leftArray addObjectsFromArray:array];
    [leftArray  addObjectsFromArray:rightarray];
    return leftArray;
}
- (void)cloudPictureCell:(CloudPictureCell *)cell clickInfo:(NSDictionary *)dic Select:(BOOL)isSelected
{
    if (isSelected) {
        [selectedArray addObject:dic];
    }else if([selectedArray containsObject:dic]){
        [selectedArray removeObject:dic];
    }
}
- (void)handleEnsureClick
{
    if (!selectedArray.count) {
        [self showPopAlerViewRatherThentasView:YES WithMes:@"è¯·éæ©å¾ç"];
        return;
    }
    
    if (_viewState == DeleteState) {
        [self showDeletePhotoesView];
        return;
    }
    if (_viewState == ShareState) {
        if (!_shareBox){
            _shareBox = [[ShareBox alloc] init];
            _shareBox.delegate = self;
        }
        [_shareBox showShareViewWithWeixinShow:NO photoWall:YES  andWriteImage:NO OnView:self.view];
    }
}

#pragma mark - Delete Photos
- (void)showDeletePhotoesView
{
    PopAlertView * alertView = [[PopAlertView alloc] initWithTitle:nil message:@"ç¡®è®¤å é¤å¾ç" delegate:self cancelButtonTitle:@"åæ¶" otherButtonTitles:@"ç¡®è®¤", nil];
    [alertView show];
    return;
}
- (void)alertView:(UIAlertView *)alertView clickedButtonAtIndex:(NSInteger)buttonIndex
{
    if (buttonIndex == 1) {
        
        [RequestManager deletePhotosWithaccessToken:[LoginStateManager currentToken] photoIds:[self photosIdArray] success:^(NSString *response)
         {
             [self refrshDataFromNetWork];
             [self showPopAlerViewRatherThentasView:NO WithMes:@"å é¤æå"];
             [self setViewState:NomalState];
         } failure:^(NSString *error) {
             [self showPopAlerViewRatherThentasView:NO WithMes:error];
             [self setViewState:NomalState];
         }];
    }
}
- (NSArray *)photosIdArray
{
    NSMutableArray * array = [NSMutableArray arrayWithCapacity:0];
    for (NSDictionary * dic in selectedArray) {
        [array addObject:[dic objectForKey:@"id"]];
    }
    return array;
}

#pragma mark Share
- (void)shareBoxViewShareTo:(shareModel)model
{
    [self.navigationController pushViewController:[[ShareViewController alloc] initWithModel:model bgPhotoUrl:[[selectedArray objectAtIndex:0] objectForKey:@"photo_url"] andDelegate:self] animated:YES];
}
- (void)shareBoxViewWeiXinShareToScene:(enum WXScene)scene
{
    [self respImageContentToSence:scene];
}

- (void)shareViewcontrollerDidShareClick:(ShareViewController *)controller withDes:(NSString *)des shareMode:(shareModel)model
{
    [RequestManager sharePhotosWithAccesstoken:[LoginStateManager currentToken]  photoIDs:[self photosIdArray] share_to:model shareAccestoken:nil  optionalTitle:@"title" desc:des success:^(NSString *response) {
        [self showPopAlerViewRatherThentasView:NO WithMes:@"åäº«æå"];
        [selectedArray removeAllObjects];
        [self setViewState:NomalState];
    } failure:^(NSString *error) {
        [self showPopAlerViewRatherThentasView:NO WithMes:error];
    }];
    [self.navigationController popViewControllerAnimated:YES];
    
}
#pragma mark - Weixin
-(void) onReq:(BaseReq*)req
{
    
}
- (void) respImageContentToSence:(enum WXScene)scene
{
//    //åéåå®¹ç»å¾®ä¿¡
//    WXMediaMessage *message = [WXMediaMessage message];
//    message.title = @"éº¦å½å³âéå®è¿æé£åâå¶å®ä¸æ¯å«çé®é¢";
//    message.description = @"3.15æä¼æ­åºå½æï¼éº¦å½å³è¯¥åºæå¨è¾åºçå«çãå·¥åé¨é¨å°±è¿å¤ç»é¨è°æ¥ï¼å¹¶å¯¹è¾è®¯è´¢ç»ç­åªä½å¬å¸åæ­¥ç»æï¼èå°½ç®¡æªæ¥å°é­åºå¤ç½éç¥ï¼éº¦å½å³ä¸­å½æ»é¨è¿æ¯å¨åå¸éæ­å£°æåæåäºè¯¥åºè¥ä¸ã\
//    \
//    ä¸å¾ä¸æ¿è®¤ï¼éº¦å½å³âéå®è¿æé£åâåºç¶æ¯äºå®ï¼ä½è¿ä¸ªâè¿æâä»ä»æ¯ä»ä»¬èªå·±å®ä¹çè¿æï¼æ®éä¸­å½å®¶åº­ä¹ä¸ä¼æåç¸åºæ¥30åéçé¸¡ç¿æ¿å»ææãéº¦å½å³å¨é£åå«çä¸çä¸¥æ ¼ç¨åº¦ï¼ä¸ä»è¿è¿è¶åºäºä¸è¬å½åä¼ä¸ï¼èä¸ä¹è¶åºäºä¸è¬ä¸­å½æ°ä¼çå¿çé¢æåçæ´»æ³è±¡ãå¤§å¤æ°äººä»¥åå¹¶ä¸ç¥éï¼éº¦å½å³å¨æ¿çé£åæ¶ä¸è¿æè®¡æ¶å¨ï¼è¾£é¸¡ç¿ç­å¤§å¤æ°é£åå­æ¾åä¸ªå°æ¶ä¹åï¼æè§å®å°±åºè¯¥ææãä¹æ­£å å¦æ­¤ï¼çè³æç½åè®¤ä¸ºå¤®è§3.15æä¼çæåæ¯ç»éº¦å½å³åçè½¯å¹¿åã\
//    \
//    å¤®è§è§é¢ä¸­åæ çæåµï¼é¤äºæå°å°ä¸ççé£åæªç»ä»»ä½å¤çç»§ç»­å å·¥æ¾å¾å¾è¿åå¤ï¼å¶å®çé®é¢é½æºäºéº¦å½å³èªå·±å¶å®çæ åè¿è¿è¶åºäºå½åä¸è¬å¿«é¤åºçæ åãæ¯å¦åäº¬å¸å«ççç£æç¸å³è´è´£äººä»ç»ï¼éº¦å½å³åé¨è¦æ±çèå¨70âç¯å¢ä¸ä¿å­2å°æ¶ï¼æ¯ä¸ºäºä¿å­é£åé£å³ï¼å±äºä¼ä¸åé¨å«çè§èãç®åçæ£æ¥ç»ææ¾ç¤ºï¼éº¦å½å³çä¿æ¸©çæ¸©åº¦å¨93âï¼ä½å¨è¿ç§ç¯å¢ä¸ä¿å­ççèå³ä¾¿è¶è¿2å°æ¶ï¼å¯¹å¬ä¼ä¹æ²¡æå±å®³ãä¹å°±æ¯è¯´éº¦å½å³çä¸äºä¿ææ¶é´æ åæ¯åºäºä¿æå¶é£åçç¬ç¹é£å³çè¦æ±ï¼å¹¶éé£ååçåè´¨å¯è½æå®³æ¶è´¹èèº«ä½å¥åº·çæ åï¼éº¦å½å³è¿å®¶é¨åºè¶æ¶å­æ¾é£åçè¡ä¸ºï¼è¿åçæ¯ä¼ä¸å¶å®çåé¨æ åï¼å¹¶ä¸è¿åé£åå®å¨è§å®ï¼æ¿åºåºè¯¥ä¾æ®æ³å¾æ³è§æ¥çç®¡é£åå«çï¼èä¸æ¯æç§é£åå¬å¸èªå·±å¶å®çæ åï¼ä»è¿ä¸ªè§åº¦æ¥çï¼éº¦å½å³å¨é£åå«çä¸æ²¡æè´£ä»»ï¼é¤äºä½¿ç¨æå¨å°ä¸çé£ç©ï¼ãâ¦[è¯¦ç»]\
//    \
//    ä½ä¸éå±¯éº¦å½å³çè¡ä¸ºç¡®å®è¿èäºè¯ä¿¡\
//    éº¦å½å³çåé¨å«çè§å®è½ç¶å¹¶æªè¢«ä½ä¸ºåç¹è¿è¡å®£æ¬ï¼ä½æ´å¿«é¤å¨ä¸­å½æ¯ä¾¿æ·åå«ççä»£åè¯ï¼å´æ¯ä¸äºçäºå®ãè°ä¹ä¸æ¯æ´»é·éï¼éº¦å½å³å¶å®çä¸¥èåé¨æ åï¼ä¸ºçæ¯æ ç«èªå·±çåçä¼å¿ï¼è¿èå¨å¸åºå®ä½ä¸åå¾ææ¾çä»·æ ¼ä¼å¿ï¼æèè¯´è®©èªå·±âè´µå¾æçç±âãä½å¦æä»çåå·¥å¨æ§è¡ä¸ä¸è½è´¯å½»è¿ä¸ä¼ä¸æ åï¼ç¸å¯¹äºå¶ä»·æ ¼æ°´å¹³èè¨ï¼å°±ææ¬ºè¯åæå®³æ¶è´¹èæçä¹å«ï¼è¿ä¹æ¯ä¸è¨èå»çãä»è¿ä¸ªæä¹ä¸æ¥è¯´ï¼å¤®è§æåéº¦å½å³çé®é¢å¹¶æ ä¸å¦¥ï¼éº¦å½å³è³å°æ¶å«æ¶è´¹æ¬ºè¯ï¼å ä¸ºå®æ²¡æåæ¶è´¹èæä¾å®åäººä»¬æ¿è¯ºçæ åçé£åãä¹å°±æ¯è¯´ï¼å·¥åé¨é¨èéé£åå«ççç®¡é¨é¨çº¦è°éº¦å½å³ï¼ä¹å¹¶éå¸åºæ åã";
//    [message setThumbImage:[UIImage imageNamed:@"res2.jpg"]];
//    WXWebpageObject *ext = [WXWebpageObject object];
//    ext.webpageUrl = @"http://view.news.qq.com/zt2012/mdl/index.htm";
//    message.mediaObject = ext;
//    SendMessageToWXReq* req =[[SendMessageToWXReq alloc] init];
//    req.bText = NO;
//    req.message = message;
//    req.scene = scene;
//    [WXApi sendReq:req];
}
@end
